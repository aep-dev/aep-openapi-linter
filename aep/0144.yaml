aliases:
  UpdateArrayOperation:
    description: An Update Array operation is a post request that updates an array with add or remove operation
    targets:
      - formats: ['oas2', 'oas3']
        given:
          - $.paths[?(@property.match(/:(add|remove)([^/]*)$/))]

rules:
  aep-144-update-array-operation-id:
    description: The operation ID must begin with the word add or remove.
    message: The operation ID does not conform to AEP-144.
    severity: error
    formats: ['oas2', 'oas3']
    given: '#UpdateArrayOperation[*].operationId'
    then:
      function: pattern
      functionOptions:
        match: '^(add|remove)[A-Z].*$'

  aep-144-http-method:
    description: An Update Array operation must be POST.
    severity: error
    formats: ['oas2', 'oas3']
    given: '#UpdateArrayOperation'
    then:
      function: schema
      functionOptions:
        schema:
          type: object
          properties:
            post: {}
          additionalProperties: false
